(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[2],{0:function(e,n,r){e.exports=r("2f39")},"0047":function(e,n,r){},"17c8":function(e,n,r){"use strict";r("63d9");var t=r("5a89"),a=r("1bee");function o(e,n){var r=a["a"].getRhino3dm(),t=n,i=[];if(e instanceof r.LineCurve)return[e.pointAtStart,e.pointAtEnd];if(e instanceof r.PolylineCurve){t=e.pointCount;for(var s=0;s<t;s++)i.push(e.point(s));return i}if(e instanceof r.PolyCurve){for(var l=e.segmentCount,c=0;c<l;c++){var u=e.segmentCurve(c),d=o(u);i=i.concat(d),u.delete()}return i}e instanceof r.NurbsCurve&&1===e.degree&&console.info("degree 1 curve");for(var h=e.domain,p=t-1,f=0;f<t;f++){var b=h[0]+f/p*(h[1]-h[0]);i.push(e.pointAt(b))}return i}var i={createGrid:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:70,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,a=-n*e,o=a,i=n*e,s=i,l=new t["n"],c=[],u=[],d=-n;d<=n;d++){var h=d*e,p=d*e;0!==d?d%r===0?(u.push(new t["L"](h,o,0)),u.push(new t["L"](h,s,0)),u.push(new t["L"](a,p,0)),u.push(new t["L"](i,p,0))):(c.push(new t["L"](h,o,0)),c.push(new t["L"](h,s,0)),c.push(new t["L"](a,p,0)),c.push(new t["L"](i,p,0))):(u.push(new t["L"](0,o,0)),u.push(new t["L"](0,0,0)),u.push(new t["L"](a,0,0)),u.push(new t["L"](0,0,0)))}for(var f=new t["p"]({color:new t["f"](129/255,134/255,140/255),depthTest:!1,depthWrite:!1}),b=new Float32Array(3*u.length),v=0;v<u.length;v++)b[3*v]=u[v].x,b[3*v+1]=u[v].y,b[3*v+2]=u[v].z;var g=new t["c"];g.setAttribute("position",new t["b"](b,3));var w=new t["q"](g,f),y=new t["p"]({color:new t["f"](147/255,.6,160/255),depthTest:!1,depthWrite:!1});b=new Float32Array(3*c.length);for(var m=0;m<c.length;m++)b[3*m]=c[m].x,b[3*m+1]=c[m].y,b[3*m+2]=c[m].z;g=new t["c"],g.setAttribute("position",new t["b"](b,3));var M=new t["q"](g,y);l.add(M),l.add(w),b=new Float32Array([0,0,0,i,0,0]),g=new t["c"],g.setAttribute("position",new t["b"](b,3));var O=new t["p"]({color:new t["f"](150/255,75/255,75/255),depthTest:!1,depthWrite:!1});l.add(new t["q"](g,O)),b=new Float32Array([0,0,0,0,s,0]),g=new t["c"],g.setAttribute("position",new t["b"](b,3));var T=new t["p"]({color:new t["f"](75/255,150/255,75/255),depthTest:!1,depthWrite:!1});return l.add(new t["q"](g,T)),l},curveToBufferGeometry:function(e,n){for(var r=o(e,n),a=new t["c"],i=new Float32Array(3*r.length),s=0;s<r.length;s++)i[3*s]=r[s][0],i[3*s+1]=r[s][1],i[3*s+2]=r[s][2];return a.setAttribute("position",new t["b"](i,3)),a},meshWiresToThreejs:function(e,n){for(var r=e.topologyEdges(),a=r.count,o=new Float32Array(2*a*3),i=0;i<a;i++){var s=r.edgeLine(i);o[6*i]=s.from[0],o[6*i+1]=s.from[1],o[6*i+2]=s.from[2],o[6*i+3]=s.to[0],o[6*i+4]=s.to[1],o[6*i+5]=s.to[2]}r.delete();var l=new t["c"];l.setAttribute("position",new t["b"](o,3));var c=new t["f"](n.r/255,n.g/255,n.b/255),u=new t["p"]({color:c}),d=new t["q"](l,u);return d.userData["surfaceWires"]=!0,d},meshToThreejs:function(e,n){var r=e.textureCoordinates();if(0===r.count){var o=a["a"].getRhino3dm(),i=new o.Sphere([0,0,0],1e3),s=o.TextureMapping.createSphereMapping(i);e.setTextureCoordinates(s,null,!1)}r.delete();var l=new t["d"],c=l.parse(e.toThreejsJSON()),u=new t["f"](n.r/255,n.g/255,n.b/255);0===n.r&&0===n.g&&0===n.b&&(u.r=1,u.g=1,u.b=1);var d=new t["x"]({color:u,side:t["i"]}),h=new t["w"](c,d);return h.userData["diffuse"]=u,h},createThreeGeometry:function(e,n,r){var o=this,i=a["a"].getRhino3dm(),s=[],l=e.objectType;switch(l){case i.ObjectType.Point:var c=new t["E"]({color:n}),u=new t["m"],d=e.location;u.vertices.push(new t["L"](d[0],d[1],d[2])),s.push([new t["D"](u,c),e.getBoundingBox()]);break;case i.ObjectType.PointSet:for(var h=new t["E"]({color:n}),p=new t["m"],f=e.count,b=0;b<f;b++){var v=e.pointAt(b);p.vertices.push(new t["L"](v[0],v[1],v[2]))}s.push([new t["D"](p,h),e.getBoundingBox()]);break;case i.ObjectType.Curve:var g=this.curveToBufferGeometry(e,32),w=new t["f"](n.r/255,n.g/255,n.b/255),y=new t["p"]({color:w}),m=new t["o"](g,y);s.push([m,e.getBoundingBox()]);break;case i.ObjectType.Surface:console.warn("TODO: Implement surface");break;case i.ObjectType.Brep:for(var M=e.faces(),O=0;O<M.count;O++){var T=M.get(O),j=T.getMesh(i.MeshType.Any);if(j){var k=this.meshToThreejs(j,n);s.push([k,j.getBoundingBox()]),j.delete()}T.delete()}M.delete();var B=new t["n"];B.userData["surfaceWires"]=!0;for(var x=e.edges(),S=0;S<x.count;S++){var A=x.get(S),C=this.curveToBufferGeometry(A,32),D=new t["f"](n.r/255,n.g/255,n.b/255),L=new t["p"]({color:D}),F=new t["o"](C,L);B.add(F)}s.push([B,e.getBoundingBox()]);break;case i.ObjectType.Mesh:var P=this.meshToThreejs(e,n);s.push([P,e.getBoundingBox()]);var E=this.meshWiresToThreejs(e,n);s.push([E,e.getBoundingBox()]);break;case i.ObjectType.Light:console.warn("TODO: Implement light");break;case i.ObjectType.Annotation:console.warn("TODO: Implement annotation");break;case i.ObjectType.InstanceReference:var G=e.parentIdefId,W=e.xform.toFloatArray(!0),I=new t["n"],R=new t["v"];R.set(W[0],W[1],W[2],W[3],W[4],W[5],W[6],W[7],W[8],W[9],W[10],W[11],W[12],W[13],W[14],W[15]),I.applyMatrix(R),s.push([I,null]);var q=r.instanceDefinitions(),J=r.objects(),N=q.findId(G),_=N.getObjectIds();_.forEach((function(e){var n=J.findId(e),t=n.geometry(),a=n.attributes(),i=a.drawColor(r),s=o.createThreeGeometry(t,i,r);s.forEach((function(e){I.add(e[0])}))})),J.delete(),q.delete();break;case i.ObjectType.TextDot:console.log("TODO: Implement dots");break;case i.ObjectType.Hatch:console.warn("TODO: Implement hatch");break;case i.ObjectType.SubD:console.warn("TODO: Implement SubD");break;case i.ObjectType.ClipPlane:console.warn("TODO: Implement clipplane");break;case i.ObjectType.Extrusion:var V=e.getMesh(i.MeshType.Any);if(V){var $=this.meshToThreejs(V,n);s.push([$,V.getBoundingBox()]),V.delete()}break;default:break}return s},createPBRMaterial:function(e,n){var r=new t["y"];r.metalness=.75,r.roughness=.15,r.normalScale.x=1,r.normalScale.y=1;var a=new t["J"];a.setPath("statics/materials/PBR/"+e+"/"),r.aoMmap=a.load(e+"_ao.png"),r.normalMap=a.load(e+"_normal.png"),r.metalnessMap=a.load(e+"_metallic.png"),a.load(e+"_base.png",(function(e){r.map=e,n(r)}))}};n["a"]=i},"1bee":function(e,n,r){"use strict";r("28a5"),r("aef6"),r("a481"),r("7f7f");var t=r("5a89"),a=r("5a15"),o={readFile:function(e,n){var r=O.getRhino3dm(),t=new a["a"],o=t.parse(n),i=new r.File3dm,s=new r.Layer;s.name="Default",i.layers().add(s);var l=new r.ObjectAttributes;return l.layersIndex=0,o.children.forEach((function(e){if("Mesh"===e.type){var n=r.Mesh.createFromThreejsJSON(e.geometry.toJSON());e.material.color?(l.colorSource=r.ObjectColorSource.ColorFromObject,l.objectColor={r:255*e.material.color.r,g:255*e.material.color.g,b:255*e.material.color.b,a:255}):l.colorSource=r.ObjectColorSource.ColorFromLayer,i.objects().addMesh(n,l)}})),i}},i=o,s={readFile:function(e,n){var r=O.getRhino3dm(),t=r.DracoCompression.decompressByteArray(n),a=new r.File3dm,o=new r.Layer;o.name="Default",a.layers().add(o);var i=new r.ObjectAttributes;i.layersIndex=0,a.objects().addMesh(t,i),O.setActiveDoc(e,a)}},l=s,c=r("21cb"),u={readFile:function(e,n){var r=O.getRhino3dm(),t=new c["a"],a=t.parse(n),o=new r.File3dm,i=new r.Layer;i.name="Default",o.layers().add(i);var s=new r.ObjectAttributes;s.layersIndex=0;var l=r.Mesh.createFromThreejsJSON(a.toJSON());return o.objects().addMesh(l,s),o}},d=u,h=r("17c8"),p=r("cbaf"),f=null,b=null,v=[],g={docExists:!1,filename:"rview WIP",expanded:["Layers"],layers:[],perspectiveCamera:!0,onChangeCamera:function(){},currentMaterialStyle:"Basic",materialOptions:["Basic","PBR: Carbon Fiber","PBR: Chipped Paint Metal","PBR: Scuffed Plastic","PBR: Streaked Metal"],displayMode:null},w={rhinoDoc:null,three:{background:null,middleground:null,setBackground:null},threeObjectsOnLayer:{},threeGrid:null,cameraLight:null,displayModes:null};function y(e,n,r){n.forEach((function(n){e.layers.hasOwnProperty(n)||(e.layers[n]={visible:!0,layers:{}}),e=e.layers[n]})),e.visible=r.visible}function m(e){var n=[],r=Object.getOwnPropertyNames(e.layers);return r.forEach((function(r){var t={label:r,visible:e.layers[r].visible},a=m(e.layers[r]);a.length>0&&(t.children=a),n.push(t)})),n}var M={init:function(e,n,r){var t=this;if(w.displayModes=p["a"].defaultModes(),this.setActiveDisplayMode("Shaded",!1),null==f){var a=e();console.log("start loading rhino3dm"),n(),a.then((function(e){if(f=e,r(),console.log("rhino3dm loaded"),null!=b){var n=b[0],a=b[1];b=null,t.openFile(n,a)}}))}},getRhino3dm:function(){return f},viewModel:function(){return g},updateVisibility:function(){g.layers.forEach((function(e){var n=w.threeObjectsOnLayer[e.label];null!=n&&n.forEach((function(n){n.visible=e.visible,n.visible&&"Mesh"===n.type&&(n.visible=g.displayMode.showSurfaceMeshes),n.visible&&n.userData["surfaceWires"]&&(n.visible=g.displayMode.showSurfaceWires)}))})),w.threeGrid&&(w.threeGrid.visible=g.displayMode.showGrid)},setActiveDisplayMode:function(e){for(var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=0;r<w.displayModes.length;r++)if(w.displayModes[r].name===e){g.displayMode=w.displayModes[r];break}n&&this.regen()},updateColors:function(){var e=g.displayMode;w.cameraLight.color=new t["f"](e.lightColor),e.backgroundStyle===p["a"].backgroundModes[0]?w.three.setBackground(w.three.background,e.backgroundColor):e.backgroundStyle===p["a"].backgroundModes[1]?w.three.setBackground(w.three.background,e.backgroundGradientTop,e.backgroundGradientBottom):w.three.setBackground(w.three.background,null,null,e.backgroundStyle)},updateMaterial:function(){if(g.currentMaterialStyle!==g.materialOptions[0]){var e=g.currentMaterialStyle.substr("PBR: ".length).toLowerCase();e=e.replace(/ /g,"-"),h["a"].createPBRMaterial(e,this.applyMaterial)}else this.applyMaterial(null)},regen:function(){this.updateVisibility(),this.updateColors(),this.updateMaterial()},applyMaterial:function(e){g.layers.forEach((function(n){var r=w.threeObjectsOnLayer[n.label];null!=r&&r.forEach((function(n){if("Mesh"===n.type)if(n.material&&(n.material.dispose(),n.material=null),null==e){var r=n.userData["diffuse"];n.material=new t["x"]({color:r,side:t["i"]}),g.displayMode.transparency&&(n.material.opacity=g.displayMode.transparency,n.material.transparent=!0)}else n.material=e}))}))},openFile:function(e,n){if(null!=f)if(e.endsWith(".obj")){var r=i.readFile(e,n);this.setActiveDoc(e,r)}else if(e.endsWith(".drc"))l.readFile(e,n);else if(e.endsWith(".ply")){var t=d.readFile(e,n);this.setActiveDoc(e,t)}else{var a=f.File3dm.fromByteArray(n);this.setActiveDoc(e,a)}else b=[e,n]},setActiveDoc:function(e,n){if(console.log("setActiveDoc ("+e+")"),w.rhinoDoc&&w.rhinoDoc.delete(),this.disposeMiddleground(),w.threeObjectsOnLayer={},w.rhinoDoc=n,g.docExists=null!=n,g.filename=e,g.layers.length=0,n){for(var r=n.layers(),t=r.count(),a={layers:{},visible:!0},o=0;o<t;o++){var i=r.get(o),s=i.fullPath,l=s.split("::");y(a,l,i),i.delete()}g.layers=m(a),r.delete()}v.forEach((function(e){e()})),this.regen()},getActiveModel:function(){return w},addActiveDocChangedEventWatcher:function(e){v.push(e)},disposeMiddleground:function(){w.three.middleground&&(w.three.middleground.dispose(),w.three.middleground=null)},visibleObjectsBoundingBox:function(){var e=null;return g.layers.forEach((function(n){if(n.visible){var r=w.threeObjectsOnLayer[n.label];null!=r&&r.forEach((function(n){null!=n.boundingBox&&(null==e?e=n.boundingBox.clone():e.union(n.boundingBox))}))}})),e}},O=n["a"]=M},"2f39":function(e,n,r){"use strict";r.r(n);var t=r("967e"),a=r.n(t),o=(r("96cf"),r("fa84")),i=r.n(o),s=(r("7d6e"),r("e54f"),r("985d"),r("0047"),r("2b0e")),l=r("1f91"),c=r("42d2"),u=r("b05d"),d=r("f508");s["a"].use(u["a"],{config:{loading:{}},lang:l["a"],iconSet:c["a"],plugins:{Loading:d["a"]}});var h=function(){var e=this,n=e.$createElement,r=e._self._c||n;return r("div",{attrs:{id:"q-app"}},[r("router-view")],1)},p=[],f=r("1bee"),b={name:"App",mounted:function(){f["a"].init(window.rhino3dm,this.showLoading,this.hideLoading)},methods:{showLoading:function(){this.$q.loading.show()},hideLoading:function(){this.$q.loading.hide()}}},v=b,g=r("2877"),w=Object(g["a"])(v,h,p,!1,null,null,null),y=w.exports,m=r("8c4f"),M=[{path:"/",component:function(){return Promise.all([r.e(0),r.e(5)]).then(r.bind(null,"713b"))},children:[{path:"",component:function(){return Promise.all([r.e(0),r.e(1)]).then(r.bind(null,"8b24"))}},{path:"/view",component:function(){return Promise.all([r.e(0),r.e(1)]).then(r.bind(null,"8b24"))},props:function(e){return{query:e.query.q}}}]}];M.push({path:"*",component:function(){return Promise.all([r.e(0),r.e(4)]).then(r.bind(null,"e51e"))}});var O=M;s["a"].use(m["a"]);var T=function(){var e=new m["a"]({scrollBehavior:function(){return{x:0,y:0}},routes:O,mode:"hash",base:""});return e},j=function(){return k.apply(this,arguments)};function k(){return k=i()(a.a.mark((function e(){var n,r;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("function"!==typeof T){e.next=6;break}return e.next=3,T({Vue:s["a"]});case 3:e.t0=e.sent,e.next=7;break;case 6:e.t0=T;case 7:return n=e.t0,r={el:"#q-app",router:n,render:function(e){return e(y)}},e.abrupt("return",{app:r,router:n});case 10:case"end":return e.stop()}}),e)}))),k.apply(this,arguments)}function B(){return x.apply(this,arguments)}function x(){return x=i()(a.a.mark((function e(){var n,r;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,j();case 2:n=e.sent,r=n.app,n.router,new s["a"](r);case 6:case"end":return e.stop()}}),e)}))),x.apply(this,arguments)}B()},cbaf:function(e,n,r){"use strict";r("7f7f");var t=r("fc74"),a=r.n(t);function o(){var e=new u("Wireframe");return e.showSurfaceMeshes=!1,e}function i(){var e=new u("Shaded");return e}function s(){var e=new u("Ghosted");return e.transparency=.5,e}function l(){var e=new u("Rendered");return e.showGrid=!1,e.showSurfaceWires=!1,e}function c(){var e=new u("Arctic");return e.showGrid=!1,e.backgroundColor="rgb(250,250,250)",e.showSurfaceWires=!1,e}var u=function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;a()(this,e),this.name=n,this.showGrid=!0,this.backgroundStyle="Single Color",this.backgroundColor="rgb(157,163,170)",this.backgroundGradientTop="rgb(54,109,168)",this.backgroundGradientBottom="rgb(165,165,165)",this.lightColor="rgb(240,240,240)",this.showSurfaceWires=!0,this.showSurfaceMeshes=!0,this.defaultModes=function(){var e=[];return e.push(o()),e.push(i()),e.push(s()),e.push(l()),e.push(c()),e}},d={defaultModes:function(){return(new u).defaultModes()},backgroundModes:["Single Color","2 Color Gradient"]};n["a"]=d}},[[0,3,0]]]);