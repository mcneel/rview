(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[1],{"8b24":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-page",{staticClass:"flex flex-center",attrs:{id:"canvasParent"}},[e.viewmodel.docExists?e._e():n("q-card",{attrs:{flat:""}},[n("q-img",{attrs:{alt:"rview",src:"logo.png"}}),n("q-card-section",[n("div",{staticClass:"text-h6"},[e._v("rview WIP")])])],1),e.viewmodel.docExists?n("q-page-sticky",{attrs:{position:"bottom-left",offset:[10,10]}},[n("q-fab",{attrs:{color:"primary",icon:"keyboard_arrow_up",direction:"up"}},[n("q-fab-action",{attrs:{color:e.panMode?"secondary":"primary",icon:"pan_tool"},on:{click:function(t){return e.togglePan()}}},[n("q-tooltip",{attrs:{"transition-show":"flip-right","transition-hide":"flip-left"}},[e._v("\n          Pan\n        ")])],1),n("q-fab-action",{attrs:{color:"primary",icon:"zoom_out_map"},on:{click:function(t){return e.zoomExtents()}}},[n("q-tooltip",{attrs:{"transition-show":"flip-right","transition-hide":"flip-left"}},[e._v("\n          Zoom Extents\n        ")])],1),e.viewmodel.perspectiveCamera?n("q-fab-action",{attrs:{color:"primary",icon:"img:icons/2D.svg"},on:{click:function(t){return e.setProjection(!1)}}}):e._e(),e.viewmodel.perspectiveCamera?e._e():n("q-fab-action",{attrs:{color:"primary",icon:"img:icons/3D.svg"},on:{click:function(t){return e.setProjection(!0)}}})],1)],1):e._e(),e.panMode?n("q-page-sticky",{attrs:{position:"bottom-right",offset:[10,10]}},[n("q-btn",{attrs:{outline:"",rounded:"",color:"primary",label:"Pan Mode","icon-right":"close"},on:{click:function(t){return e.togglePan()}}})],1):e._e()],1)},o=[],a=(n("ace4"),n("e6cf"),n("5cc6"),n("c973")),r=n.n(a),s=n("5a89"),c=n("4721"),l=n("1bee"),d=n("17c8"),m=n("32d9"),h=n("ba3e");let u={renderer:null,camera:null,controls:null,effectComposer:null,ssaoPass:null,initialize:function(){if(null!=this.renderer)return;s["M"].DefaultUp=new s["db"](0,0,1),this.renderer=new s["gb"]({antialias:!0}),this.renderer.setPixelRatio(window.devicePixelRatio);let e=document.getElementById("canvasParent");this.renderer.setSize(e.clientWidth,e.clientHeight),e.appendChild(this.renderer.domElement),window.addEventListener("resize",()=>p(!0),!1),this.camera=new s["O"](30,e.clientWidth/e.clientHeight,1,1e3),this.camera.position.z=40,this.controls=new c["a"](this.camera,this.renderer.domElement),this.controls.screenSpacePanning=!0},zoomExtents:function(e){let t=l["a"].getRhino3dm(),n=l["a"].viewModel().perspectiveCamera?t.ViewportInfo.defaultPerspective():t.ViewportInfo.defaultTop(),i=new s["cb"](0,0);u.renderer.getSize(i),n.screenPort=[0,0,i.x,i.y];let o=l["a"].visibleObjectsBoundingBox(),a=new t.BoundingBox(o.min.x,o.min.y,o.min.z,o.max.x,o.max.y,o.max.z),r=a.center,c=a.max[0]-a.min[0],d=a.max[1]-a.min[1],m=a.max[2]-a.min[2];a.inflate(.2*c,.2*d,.2*m);let h=c,p=h*i.y/i.x;if(n.setFrustum(-h/2,h/2,-p/2,p/2,.1,1e3),n.extents(50*Math.PI/180,a),a.delete(),e){l["a"].getActiveModel().three.middleground.remove(this.camera);let e=n.getFrustum();l["a"].viewModel().perspectiveCamera?this.camera=new s["O"](30,i.x/i.y,e.near,e.far):(this.camera=new s["N"](e.left,e.right,e.top,e.bottom,e.near,e.far),this.camera.up.set(n.cameraUp[0],n.cameraUp[1],n.cameraUp[2])),this.controls.object=this.camera;let t=new s["m"](l["a"].viewModel().lightColor);t.position.set(0,0,1),l["a"].getActiveModel().cameraLight=t,this.camera.add(t),l["a"].getActiveModel().three.middleground.add(this.camera)}let f=n.cameraLocation;this.camera.position.set(f[0],f[1],f[2]),this.camera.updateProjectionMatrix(),this.controls.target.set(r[0],r[1],r[2]),n.delete()},enableSSAO(e){if(this.effectComposer)this.effectComposer.passes[0].enabled=e;else if(e){this.effectComposer=new m["a"](this.renderer);let e=l["a"].getActiveModel(),t=document.getElementById("canvasParent");this.ssaoPass=new h["a"](e.three.middleground,this.camera,t.clientWidth,t.clientHeight),this.ssaoPass.kernelRadius=18,this.ssaoPass.minDistance=.002,this.ssaoPass.maxDistance=.2,this.ssaoPass.output=h["a"].OUTPUT.SSAO,this.effectComposer.addPass(this.ssaoPass)}}},p=function(e=!1){let t=document.getElementById("canvasParent"),n=t.clientWidth,i=t.clientHeight;(e||u.effectComposer)&&(u.camera.aspect=t.clientWidth/t.clientHeight,u.camera.updateProjectionMatrix(),u.renderer.setSize(t.clientWidth,t.clientHeight),u.effectComposer&&u.effectComposer.setSize(t.clientWidth,t.clientHeight)),requestAnimationFrame(p),u.controls.update(),d["a"].viewportSize.width=n,d["a"].viewportSize.height=i;let o=l["a"].getActiveModel();u.renderer.autoClear=!1,u.renderer.sortObjects=!1,u.renderer.render(o.three.background,u.camera),u.renderer.sortObjects=!0,u.effectComposer&&u.effectComposer.passes[0].enabled?u.effectComposer.render():u.renderer.render(o.three.middleground,u.camera)};function f(e,t,n=null,i=null){if(n||i||(e.background=new s["h"](t)),t&&n){let i=document.createElement("canvas");i.width=128,i.height=128;let o=i.getContext("2d"),a=o.createLinearGradient(0,0,0,i.height);a.addColorStop(1,n),a.addColorStop(.1,t),o.fillStyle=a,o.fillRect(0,0,i.width,i.height),e.background=new s["f"](i)}if(i){let t=new s["i"];t.setPath("cubemaps/"+i+"/");let n=t.load(["px.jpg","nx.jpg","py.jpg","ny.jpg","pz.jpg","nz.jpg"]);e.background=n,p(!0)}}function g(){u.initialize(),l["a"].disposeMiddleground();let e=l["a"].getActiveModel();if(e.three.middleground=new s["V"],null==e.three.background){e.three.background=new s["V"],e.three.background.background=new s["h"](.75,.75,.75);let t=d["a"].createGrid();e.threeGrid=t,e.three.background.add(t)}e.three.setBackground=f}function w(){console.log("Building Scene"),g();let e=l["a"].getActiveModel(),t=e.rhinoDoc,n=t.objects();for(let i=0;i<n.count;i++){let o=n.get(i);if(null==o)continue;let a=o.geometry(),r=o.attributes();if(r.isInstanceDefinitionObject)continue;let c=t.layers().get(r.layerIndex),l=c.fullPath.split("::")[0];e.threeObjectsOnLayer[l]||(e.threeObjectsOnLayer[l]=[]);let m=d["a"].createThreeGeometry(a,r,t);m.forEach(t=>{let n=t[0],i=t[1];if(i){let e=new s["db"](i.min[0],i.min[1],i.min[2]),t=new s["db"](i.max[0],i.max[1],i.max[2]);n.boundingBox=new s["b"](e,t),i.delete()}e.three.middleground.add(n),e.threeObjectsOnLayer[l].push(n)}),o.delete(),a.delete(),r.delete()}n.delete(),l["a"].updateVisibility(),u.zoomExtents(!0),p()}function v(){let e="Arctic"===l["a"].viewModel().displayMode.name;u.enableSSAO(e)}var b={data(){let e=l["a"].viewModel();return{panMode:!1,viewmodel:e}},props:{url:{type:String,default:""}},created(){l["a"].addActiveDocChangedEventWatcher(w),l["a"].addDisplayModeChangedEventWatcher(v),this.viewmodel.onChangeCamera=this.updateCameraProjection},mounted(){this.$route.query&&this.$route.query["url"]&&(console.log("MOUNTED with "+this.$route.query["url"]),this.openURL(this.$route.query["url"])),console.log("MOUNTED")},watch:{$route(e,t){e.query["url"]&&this.openURL(e.query["url"]),console.log(e.query)}},methods:{openURL(e){fetch(e).then(function(){var t=r()((function*(t){let n=yield t.arrayBuffer(),i=new Uint8Array(n);l["a"].openFile(e,i)}));return function(e){return t.apply(this,arguments)}}())},updateCameraProjection(){u.zoomExtents(!0),this.setLeftButtonMode()},zoomExtents(){u.zoomExtents(!0)},togglePan(){this.panMode=!this.panMode,this.setLeftButtonMode()},setProjection(e){this.viewmodel.perspectiveCamera!==e&&(this.viewmodel.perspectiveCamera=e,this.updateCameraProjection(),this.zoomExtents())},setLeftButtonMode(){this.panMode||!this.viewmodel.perspectiveCamera?(u.controls.mouseButtons.LEFT=s["B"].PAN,u.controls.touches.ONE=s["Y"].PAN):(u.controls.mouseButtons.LEFT=s["B"].ROTATE,u.controls.touches.ONE=s["Y"].ROTATE)}}},y=b,x=n("2877"),P=n("9989"),C=n("f09f"),M=n("068f"),E=n("a370"),j=n("de5e"),O=n("c294"),k=n("72db"),q=n("05c0"),z=n("9c40"),S=n("eebe"),A=n.n(S),B=Object(x["a"])(y,i,o,!1,null,null,null);t["default"]=B.exports;A()(B,"components",{QPage:P["a"],QCard:C["a"],QImg:M["a"],QCardSection:E["a"],QPageSticky:j["a"],QFab:O["a"],QFabAction:k["a"],QTooltip:q["a"],QBtn:z["a"]})}}]);