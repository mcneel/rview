(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[2],{0:function(e,n,r){e.exports=r("2f39")},"0047":function(e,n,r){},"17c8":function(e,n,r){"use strict";r("63d9");var t=r("5a89"),a=r("1bee");function o(e,n){var r=a["a"].getRhino3dm(),t=n,i=[];if(e instanceof r.LineCurve)return[e.pointAtStart,e.pointAtEnd];if(e instanceof r.PolylineCurve){t=e.pointCount;for(var l=0;l<t;l++)i.push(e.point(l));return i}if(e instanceof r.PolyCurve){for(var c=e.segmentCount,s=0;s<c;s++){var u=e.segmentCurve(s),d=o(u);i=i.concat(d),u.delete()}return i}e instanceof r.NurbsCurve&&1===e.degree&&console.info("degree 1 curve");for(var h=e.domain,p=t-1,f=0;f<t;f++){var b=h[0]+f/p*(h[1]-h[0]);i.push(e.pointAt(b))}return i}var i={createGrid:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:70,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,a=-n*e,o=a,i=n*e,l=i,c=new t["n"],s=[],u=[],d=-n;d<=n;d++){var h=d*e,p=d*e;0!==d?d%r===0?(u.push(new t["L"](h,o,0)),u.push(new t["L"](h,l,0)),u.push(new t["L"](a,p,0)),u.push(new t["L"](i,p,0))):(s.push(new t["L"](h,o,0)),s.push(new t["L"](h,l,0)),s.push(new t["L"](a,p,0)),s.push(new t["L"](i,p,0))):(u.push(new t["L"](0,o,0)),u.push(new t["L"](0,0,0)),u.push(new t["L"](a,0,0)),u.push(new t["L"](0,0,0)))}for(var f=new t["p"]({color:1118481,depthTest:!1,depthWrite:!1}),b=new Float32Array(3*u.length),g=0;g<u.length;g++)b[3*g]=u[g].x,b[3*g+1]=u[g].y,b[3*g+2]=u[g].z;var v=new t["c"];v.setAttribute("position",new t["b"](b,3));var w=new t["q"](v,f),m=new t["p"]({color:7829367,depthTest:!1,depthWrite:!1});b=new Float32Array(3*s.length);for(var y=0;y<s.length;y++)b[3*y]=s[y].x,b[3*y+1]=s[y].y,b[3*y+2]=s[y].z;v=new t["c"],v.setAttribute("position",new t["b"](b,3));var O=new t["q"](v,m);c.add(w),c.add(O),b=new Float32Array([0,0,0,i,0,0]),v=new t["c"],v.setAttribute("position",new t["b"](b,3));var T=new t["p"]({color:new t["f"](150/255,75/255,75/255),depthTest:!1,depthWrite:!1});c.add(new t["q"](v,T)),b=new Float32Array([0,0,0,0,l,0]),v=new t["c"],v.setAttribute("position",new t["b"](b,3));var j=new t["p"]({color:new t["f"](75/255,150/255,75/255),depthTest:!1,depthWrite:!1});return c.add(new t["q"](v,j)),c},curveToBufferGeometry:function(e,n){for(var r=o(e,n),a=new t["c"],i=new Float32Array(3*r.length),l=0;l<r.length;l++)i[3*l]=r[l][0],i[3*l+1]=r[l][1],i[3*l+2]=r[l][2];return a.setAttribute("position",new t["b"](i,3)),a},meshToThreejs:function(e,n){var r=e.textureCoordinates();if(0===r.count){var o=a["a"].getRhino3dm(),i=new o.Sphere([0,0,0],1e3),l=o.TextureMapping.createSphereMapping(i);e.setTextureCoordinates(l,null,!1)}r.delete();var c=new t["d"],s=c.parse(e.toThreejsJSON());0===n.r&&0===n.g&&0===n.b&&(n.r=255,n.g=255,n.b=255);var u=new t["f"](n.r/255,n.g/255,n.b/255),d=new t["x"]({color:u,side:t["i"]}),h=new t["w"](s,d);return h.userData["diffuse"]=u,h},createThreeGeometry:function(e,n,r){var o=this,i=a["a"].getRhino3dm(),l=[],c=e.objectType;switch(c){case i.ObjectType.Point:var s=new t["E"]({color:n}),u=new t["m"],d=e.location;u.vertices.push(new t["L"](d[0],d[1],d[2])),l.push([new t["D"](u,s),e.getBoundingBox()]);break;case i.ObjectType.PointSet:for(var h=new t["E"]({color:n}),p=new t["m"],f=e.count,b=0;b<f;b++){var g=e.pointAt(b);p.vertices.push(new t["L"](g[0],g[1],g[2]))}l.push([new t["D"](p,h),e.getBoundingBox()]);break;case i.ObjectType.Curve:var v=this.curveToBufferGeometry(e,32),w=new t["f"](n.r/255,n.g/255,n.b/255),m=new t["p"]({color:w}),y=new t["o"](v,m);l.push([y,e.getBoundingBox()]);break;case i.ObjectType.Surface:console.warn("TODO: Implement surface");break;case i.ObjectType.Brep:for(var O=e.faces(),T=0;T<O.count;T++){var j=O.get(T),k=j.getMesh(i.MeshType.Any);if(k){var B=this.meshToThreejs(k,n);l.push([B,k.getBoundingBox()]),k.delete()}j.delete()}O.delete();break;case i.ObjectType.Mesh:var x=this.meshToThreejs(e,n);l.push([x,e.getBoundingBox()]);break;case i.ObjectType.Light:console.warn("TODO: Implement light");break;case i.ObjectType.Annotation:console.warn("TODO: Implement annotation");break;case i.ObjectType.InstanceReference:var L=e.parentIdefId,M=e.xform.toFloatArray(!0),C=new t["n"],A=new t["v"];A.set(M[0],M[1],M[2],M[3],M[4],M[5],M[6],M[7],M[8],M[9],M[10],M[11],M[12],M[13],M[14],M[15]),C.applyMatrix(A),l.push([C,null]);var D=r.instanceDefinitions(),S=r.objects(),P=D.findId(L),F=P.getObjectIds();F.forEach((function(e){var n=S.findId(e),t=n.geometry(),a=n.attributes(),i=a.drawColor(r),l=o.createThreeGeometry(t,i,r);l.forEach((function(e){C.add(e[0])}))})),S.delete(),D.delete();break;case i.ObjectType.TextDot:console.warn("TODO: Implement dot");break;case i.ObjectType.Hatch:console.warn("TODO: Implement hatch");break;case i.ObjectType.SubD:console.warn("TODO: Implement SubD");break;case i.ObjectType.ClipPlane:console.warn("TODO: Implement clipplane");break;case i.ObjectType.Extrusion:var E=e.getMesh(i.MeshType.Any);if(E){var I=this.meshToThreejs(E,n);l.push([I,E.getBoundingBox()]),E.delete()}break;default:break}return l},createPBRMaterial:function(e,n){var r=new t["y"];r.metalness=.75,r.roughness=.15,r.normalScale.x=1,r.normalScale.y=1;var a=new t["J"];a.setPath("statics/materials/PBR/"+e+"/"),r.aoMmap=a.load(e+"_ao.png"),r.normalMap=a.load(e+"_normal.png"),r.metalnessMap=a.load(e+"_metallic.png"),a.load(e+"_base.png",(function(e){r.map=e,n(r)}))}};n["a"]=i},"1bee":function(e,n,r){"use strict";r("28a5"),r("aef6"),r("a481");var t=r("5a89"),a=(r("7f7f"),r("5a15")),o={readFile:function(e,n){var r=O.getRhino3dm(),t=new a["a"],o=t.parse(n),i=new r.File3dm,l=new r.Layer;l.name="Default",i.layers().add(l);var c=new r.ObjectAttributes;return c.layersIndex=0,o.children.forEach((function(e){if("Mesh"===e.type){var n=r.Mesh.createFromThreejsJSON(e.geometry.toJSON());e.material.color?(c.colorSource=r.ObjectColorSource.ColorFromObject,c.objectColor={r:255*e.material.color.r,g:255*e.material.color.g,b:255*e.material.color.b,a:255}):c.colorSource=r.ObjectColorSource.ColorFromLayer,i.objects().addMesh(n,c)}})),i}},i=o,l={readFile:function(e,n){var r=O.getRhino3dm(),t=r.DracoCompression.decompressByteArray(n),a=new r.File3dm,o=new r.Layer;o.name="Default",a.layers().add(o);var i=new r.ObjectAttributes;i.layersIndex=0,a.objects().addMesh(t,i),O.setActiveDoc(e,a)}},c=l,s=r("21cb"),u={readFile:function(e,n){var r=O.getRhino3dm(),t=new s["a"],a=t.parse(n),o=new r.File3dm,i=new r.Layer;i.name="Default",o.layers().add(i);var l=new r.ObjectAttributes;l.layersIndex=0;var c=r.Mesh.createFromThreejsJSON(a.toJSON());return o.objects().addMesh(c,l),o}},d=u,h=r("17c8"),p=null,f=null,b=[],g={docExists:!1,filename:"rview WIP",expanded:["Layers"],layers:[],perspectiveCamera:!0,onChangeCamera:function(){},gridVisible:!0,lightColor:"rgb(240,240,240)",currentBackgroundStyle:"Single Color",backgroundOptions:["Single Color","2 Color Gradient"],backgroundColor:"rgb(190,190,190)",backgroundGradientTop:"rgb(54,109,168)",backgroundGradientBottom:"rgb(165,165,165)",currentMaterialStyle:"Basic",materialOptions:["Basic","PBR: Carbon Fiber","PBR: Chipped Paint Metal","PBR: Scuffed Plastic","PBR: Streaked Metal"]},v={rhinoDoc:null,three:{background:null,middleground:null,setBackground:null},threeObjectsOnLayer:{},threeGrid:null,cameraLight:null};function w(e,n,r){n.forEach((function(n){e.layers.hasOwnProperty(n)||(e.layers[n]={visible:!0,layers:{}}),e=e.layers[n]})),e.visible=r.visible}function m(e){var n=[],r=Object.getOwnPropertyNames(e.layers);return r.forEach((function(r){var t={label:r,visible:e.layers[r].visible},a=m(e.layers[r]);a.length>0&&(t.children=a),n.push(t)})),n}var y={init:function(e,n,r){var t=this;if(null==p){var a=e();console.log("start loading rhino3dm"),n(),a.then((function(e){if(p=e,r(),console.log("rhino3dm loaded"),null!=f){var n=f[0],a=f[1];f=null,t.openFile(n,a)}}))}},getRhino3dm:function(){return p},viewModel:function(){return g},updateVisibility:function(){g.layers.forEach((function(e){var n=v.threeObjectsOnLayer[e.label];null!=n&&n.forEach((function(n){n.visible=e.visible}))})),v.threeGrid&&(v.threeGrid.visible=g.gridVisible)},updateColors:function(){v.cameraLight.color=new t["f"](g.lightColor),g.currentBackgroundStyle===g.backgroundOptions[0]?v.three.setBackground(v.three.background,g.backgroundColor):g.currentBackgroundStyle===g.backgroundOptions[1]?v.three.setBackground(v.three.background,g.backgroundGradientTop,g.backgroundGradientBottom):v.three.setBackground(v.three.background,null,null,g.currentBackgroundStyle)},updateMaterial:function(){if(g.currentMaterialStyle!==g.materialOptions[0]){var e=g.currentMaterialStyle.substr("PBR: ".length).toLowerCase();e=e.replace(/ /g,"-"),h["a"].createPBRMaterial(e,this.applyMaterial)}else this.applyMaterial(null)},applyMaterial:function(e){g.layers.forEach((function(n){var r=v.threeObjectsOnLayer[n.label];null!=r&&r.forEach((function(n){if("Mesh"===n.type)if(null==e){var r=n.userData["diffuse"];n.material=new t["x"]({color:r,side:t["i"]})}else n.material=e}))}))},openFile:function(e,n){if(null!=p)if(e.endsWith(".obj")){var r=i.readFile(e,n);this.setActiveDoc(e,r)}else if(e.endsWith(".drc"))c.readFile(e,n);else if(e.endsWith(".ply")){var t=d.readFile(e,n);this.setActiveDoc(e,t)}else{var a=p.File3dm.fromByteArray(n);this.setActiveDoc(e,a)}else f=[e,n]},setActiveDoc:function(e,n){if(console.log("setActiveDoc ("+e+")"),v.rhinoDoc&&v.rhinoDoc.delete(),this.disposeMiddleground(),v.threeObjectsOnLayer={},v.rhinoDoc=n,g.docExists=null!=n,g.filename=e,g.layers.length=0,n){for(var r=n.layers(),t=r.count(),a={layers:{},visible:!0},o=0;o<t;o++){var i=r.get(o),l=i.fullPath,c=l.split("::");w(a,c,i),i.delete()}g.layers=m(a),r.delete()}b.forEach((function(e){e()})),this.updateMaterial()},getActiveModel:function(){return v},addActiveDocChangedEventWatcher:function(e){b.push(e)},disposeMiddleground:function(){v.three.middleground&&(v.three.middleground.dispose(),v.three.middleground=null)},visibleObjectsBoundingBox:function(){var e=null;return g.layers.forEach((function(n){if(n.visible){var r=v.threeObjectsOnLayer[n.label];null!=r&&r.forEach((function(n){null!=n.boundingBox&&(null==e?e=n.boundingBox.clone():e.union(n.boundingBox))}))}})),e}},O=n["a"]=y},"2f39":function(e,n,r){"use strict";r.r(n);var t=r("967e"),a=r.n(t),o=(r("96cf"),r("fa84")),i=r.n(o),l=(r("7d6e"),r("e54f"),r("985d"),r("0047"),r("2b0e")),c=r("1f91"),s=r("42d2"),u=r("b05d"),d=r("f508");l["a"].use(u["a"],{config:{loading:{}},lang:c["a"],iconSet:s["a"],plugins:{Loading:d["a"]}});var h=function(){var e=this,n=e.$createElement,r=e._self._c||n;return r("div",{attrs:{id:"q-app"}},[r("router-view")],1)},p=[],f=r("1bee"),b={name:"App",mounted:function(){f["a"].init(window.rhino3dm,this.showLoading,this.hideLoading)},methods:{showLoading:function(){this.$q.loading.show()},hideLoading:function(){this.$q.loading.hide()}}},g=b,v=r("2877"),w=Object(v["a"])(g,h,p,!1,null,null,null),m=w.exports,y=r("8c4f"),O=[{path:"/",component:function(){return Promise.all([r.e(0),r.e(5)]).then(r.bind(null,"713b"))},children:[{path:"",component:function(){return Promise.all([r.e(0),r.e(1)]).then(r.bind(null,"8b24"))}},{path:"/view",component:function(){return Promise.all([r.e(0),r.e(1)]).then(r.bind(null,"8b24"))},props:function(e){return{query:e.query.q}}}]}];O.push({path:"*",component:function(){return Promise.all([r.e(0),r.e(4)]).then(r.bind(null,"e51e"))}});var T=O;l["a"].use(y["a"]);var j=function(){var e=new y["a"]({scrollBehavior:function(){return{x:0,y:0}},routes:T,mode:"hash",base:""});return e},k=function(){return B.apply(this,arguments)};function B(){return B=i()(a.a.mark((function e(){var n,r;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("function"!==typeof j){e.next=6;break}return e.next=3,j({Vue:l["a"]});case 3:e.t0=e.sent,e.next=7;break;case 6:e.t0=j;case 7:return n=e.t0,r={el:"#q-app",router:n,render:function(e){return e(m)}},e.abrupt("return",{app:r,router:n});case 10:case"end":return e.stop()}}),e)}))),B.apply(this,arguments)}function x(){return L.apply(this,arguments)}function L(){return L=i()(a.a.mark((function e(){var n,r;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,k();case 2:n=e.sent,r=n.app,n.router,new l["a"](r);case 6:case"end":return e.stop()}}),e)}))),L.apply(this,arguments)}x()}},[[0,3,0]]]);