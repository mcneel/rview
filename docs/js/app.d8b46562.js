(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[2],{0:function(e,n,r){e.exports=r("2f39")},"0047":function(e,n,r){},"17c8":function(e,n,r){"use strict";r("63d9");var t=r("5a89"),a=r("1bee"),o={vs:"\n  void main() {\n    vec4 modelViewPosition = modelViewMatrix * vec4(position, 1.0);\n    vec4 p = projectionMatrix * modelViewPosition;\n    p.z = 0.0;\n    gl_Position = p;\n  }\n  ",fs:"\n  uniform vec3 color;\n  void main() {\n    gl_FragColor = vec4(color.rgb, 1.0);\n  }\n  ",material:function(e){var n=new t["X"]({uniforms:{color:{type:"vec3",value:e}},vertexShader:this.vs,fragmentShader:this.fs,depthWrite:!1,depthTest:!1});return n}},i=o;function s(e,n){var r=a["a"].getRhino3dm(),t=n,o=[];if(e instanceof r.LineCurve)return[e.pointAtStart,e.pointAtEnd];if(e instanceof r.PolylineCurve){t=e.pointCount;for(var i=0;i<t;i++)o.push(e.point(i));return o}if(e instanceof r.PolyCurve){for(var l=e.segmentCount,c=0;c<l;c++){var u=e.segmentCurve(c),d=s(u);o=o.concat(d),u.delete()}return o}e instanceof r.NurbsCurve&&1===e.degree&&console.info("degree 1 curve");for(var h=e.domain,p=t-1,f=0;f<t;f++){var b=h[0]+f/p*(h[1]-h[0]);o.push(e.pointAt(b))}return o}var l={createGrid:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:70,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,a=-n*e,o=a,s=n*e,l=s,c=new t["v"],u=[],d=[],h=-n;h<=n;h++){var p=h*e,f=h*e;0!==h?h%r===0?(d.push(new t["eb"](p,o,0)),d.push(new t["eb"](p,l,0)),d.push(new t["eb"](a,f,0)),d.push(new t["eb"](s,f,0))):(u.push(new t["eb"](p,o,0)),u.push(new t["eb"](p,l,0)),u.push(new t["eb"](a,f,0)),u.push(new t["eb"](s,f,0))):(d.push(new t["eb"](0,o,0)),d.push(new t["eb"](0,0,0)),d.push(new t["eb"](a,0,0)),d.push(new t["eb"](0,0,0)))}for(var b=i.material(new t["h"](129/255,134/255,140/255)),v=new Float32Array(3*d.length),g=0;g<d.length;g++)v[3*g]=d[g].x,v[3*g+1]=d[g].y,v[3*g+2]=d[g].z;var w=new t["d"];w.setAttribute("position",new t["c"](v,3));var y=new t["y"](w,b),m=i.material(new t["h"](147/255,.6,160/255));v=new Float32Array(3*u.length);for(var M=0;M<u.length;M++)v[3*M]=u[M].x,v[3*M+1]=u[M].y,v[3*M+2]=u[M].z;w=new t["d"],w.setAttribute("position",new t["c"](v,3));var O=new t["y"](w,m);c.add(O),c.add(y),v=new Float32Array([0,0,0,s,0,0]),w=new t["d"],w.setAttribute("position",new t["c"](v,3));var T=i.material(new t["h"](150/255,75/255,75/255));c.add(new t["y"](w,T)),v=new Float32Array([0,0,0,0,l,0]),w=new t["d"],w.setAttribute("position",new t["c"](v,3));var j=i.material(new t["h"](75/255,150/255,75/255));return c.add(new t["y"](w,j)),c},curveToBufferGeometry:function(e,n){for(var r=s(e,n),a=new t["d"],o=new Float32Array(3*r.length),i=0;i<r.length;i++)o[3*i]=r[i][0],o[3*i+1]=r[i][1],o[3*i+2]=r[i][2];return a.setAttribute("position",new t["c"](o,3)),a},meshWiresToThreejs:function(e,n){for(var r=e.topologyEdges(),a=r.count,o=new Float32Array(2*a*3),i=0;i<a;i++){var s=r.edgeLine(i);o[6*i]=s.from[0],o[6*i+1]=s.from[1],o[6*i+2]=s.from[2],o[6*i+3]=s.to[0],o[6*i+4]=s.to[1],o[6*i+5]=s.to[2]}r.delete();var l=new t["d"];l.setAttribute("position",new t["c"](o,3));var c=new t["h"](n.r/255,n.g/255,n.b/255),u=new t["x"]({color:c}),d=new t["y"](l,u);return d.userData["surfaceWires"]=!0,d},meshToThreejs:function(e,n){var r=e.textureCoordinates();if(0===r.count){var o=a["a"].getRhino3dm(),i=new o.Sphere([0,0,0],1e3),s=o.TextureMapping.createSphereMapping(i);e.setTextureCoordinates(s,null,!1)}r.delete();var l=new t["e"],c=l.parse(e.toThreejsJSON()),u=new t["h"](n.r/255,n.g/255,n.b/255);0===n.r&&0===n.g&&0===n.b&&(u.r=1,u.g=1,u.b=1);var d=new t["I"]({color:u,side:t["n"]}),h=new t["G"](c,d);return h.userData["diffuse"]=u,h},createThreeGeometry:function(e,n,r){var o=this,i=a["a"].getRhino3dm(),s=[],l=e.objectType;switch(l){case i.ObjectType.Point:var c=new t["S"]({color:n}),u=new t["u"],d=e.location;u.vertices.push(new t["eb"](d[0],d[1],d[2])),s.push([new t["R"](u,c),e.getBoundingBox()]);break;case i.ObjectType.PointSet:for(var h=new t["S"]({color:n}),p=new t["u"],f=e.count,b=0;b<f;b++){var v=e.pointAt(b);p.vertices.push(new t["eb"](v[0],v[1],v[2]))}s.push([new t["R"](p,h),e.getBoundingBox()]);break;case i.ObjectType.Curve:var g=this.curveToBufferGeometry(e,32),w=new t["h"](n.r/255,n.g/255,n.b/255),y=new t["x"]({color:w}),m=new t["w"](g,y);s.push([m,e.getBoundingBox()]);break;case i.ObjectType.Surface:console.warn("TODO: Implement surface");break;case i.ObjectType.Brep:for(var M=e.faces(),O=0;O<M.count;O++){var T=M.get(O),j=T.getMesh(i.MeshType.Any);if(j){var k=this.meshToThreejs(j,n);s.push([k,j.getBoundingBox()]),j.delete()}T.delete()}M.delete();var B=new t["v"];B.userData["surfaceWires"]=!0;for(var x=e.edges(),S=0;S<x.count;S++){var A=x.get(S),C=this.curveToBufferGeometry(A,32),D=new t["h"](n.r/255,n.g/255,n.b/255),P=new t["x"]({color:D}),F=new t["w"](C,P);B.add(F)}s.push([B,e.getBoundingBox()]);break;case i.ObjectType.Mesh:var E=this.meshToThreejs(e,n);s.push([E,e.getBoundingBox()]);var L=this.meshWiresToThreejs(e,n);s.push([L,e.getBoundingBox()]);break;case i.ObjectType.Light:console.warn("TODO: Implement light");break;case i.ObjectType.Annotation:console.warn("TODO: Implement annotation");break;case i.ObjectType.InstanceReference:var G=e.parentIdefId,I=e.xform.toFloatArray(!0),R=new t["v"],W=new t["F"];W.set(I[0],I[1],I[2],I[3],I[4],I[5],I[6],I[7],I[8],I[9],I[10],I[11],I[12],I[13],I[14],I[15]),R.applyMatrix(W),s.push([R,null]);var J=r.instanceDefinitions(),_=r.objects(),q=J.findId(G),N=q.getObjectIds();N.forEach((function(e){var n=_.findId(e),t=n.geometry(),a=n.attributes(),i=a.drawColor(r),s=o.createThreeGeometry(t,i,r);s.forEach((function(e){R.add(e[0])}))})),_.delete(),J.delete();break;case i.ObjectType.TextDot:console.log("TODO: Implement dots");break;case i.ObjectType.Hatch:console.warn("TODO: Implement hatch");break;case i.ObjectType.SubD:console.warn("TODO: Implement SubD");break;case i.ObjectType.ClipPlane:console.warn("TODO: Implement clipplane");break;case i.ObjectType.Extrusion:var V=e.getMesh(i.MeshType.Any);if(V){var z=this.meshToThreejs(V,n);s.push([z,V.getBoundingBox()]),V.delete()}break;default:break}return s},createPBRMaterial:function(e,n){var r=new t["J"];r.metalness=.75,r.roughness=.15,r.normalScale.x=1,r.normalScale.y=1;var a=new t["ab"];a.setPath("statics/materials/PBR/"+e+"/"),r.aoMmap=a.load(e+"_ao.png"),r.normalMap=a.load(e+"_normal.png"),r.metalnessMap=a.load(e+"_metallic.png"),a.load(e+"_base.png",(function(e){r.map=e,n(r)}))}};n["a"]=l},"1bee":function(e,n,r){"use strict";r("28a5"),r("aef6"),r("a481"),r("7f7f");var t=r("5a89"),a=r("5a15"),o={readFile:function(e,n){var r=T.getRhino3dm(),t=new a["a"],o=t.parse(n),i=new r.File3dm,s=new r.Layer;s.name="Default",i.layers().add(s);var l=new r.ObjectAttributes;return l.layersIndex=0,o.children.forEach((function(e){if("Mesh"===e.type){var n=r.Mesh.createFromThreejsJSON(e.geometry.toJSON());e.material.color?(l.colorSource=r.ObjectColorSource.ColorFromObject,l.objectColor={r:255*e.material.color.r,g:255*e.material.color.g,b:255*e.material.color.b,a:255}):l.colorSource=r.ObjectColorSource.ColorFromLayer,i.objects().addMesh(n,l)}})),i}},i=o,s={readFile:function(e,n){var r=T.getRhino3dm(),t=r.DracoCompression.decompressByteArray(n),a=new r.File3dm,o=new r.Layer;o.name="Default",a.layers().add(o);var i=new r.ObjectAttributes;i.layersIndex=0,a.objects().addMesh(t,i),T.setActiveDoc(e,a)}},l=s,c=r("21cb"),u={readFile:function(e,n){var r=T.getRhino3dm(),t=new c["a"],a=t.parse(n),o=new r.File3dm,i=new r.Layer;i.name="Default",o.layers().add(i);var s=new r.ObjectAttributes;s.layersIndex=0;var l=r.Mesh.createFromThreejsJSON(a.toJSON());return o.objects().addMesh(l,s),o}},d=u,h=r("17c8"),p=r("cbaf"),f=null,b=null,v=[],g=[],w={docExists:!1,filename:"rview WIP",expanded:["Layers"],layers:[],perspectiveCamera:!0,onChangeCamera:function(){},currentMaterialStyle:"Basic",materialOptions:["Basic","PBR: Carbon Fiber","PBR: Chipped Paint Metal","PBR: Scuffed Plastic","PBR: Streaked Metal"],displayMode:null},y={rhinoDoc:null,three:{background:null,middleground:null,setBackground:null},threeObjectsOnLayer:{},threeGrid:null,cameraLight:null,displayModes:null};function m(e,n,r){n.forEach((function(n){e.layers.hasOwnProperty(n)||(e.layers[n]={visible:!0,layers:{}}),e=e.layers[n]})),e.visible=r.visible}function M(e){var n=[],r=Object.getOwnPropertyNames(e.layers);return r.forEach((function(r){var t={label:r,visible:e.layers[r].visible},a=M(e.layers[r]);a.length>0&&(t.children=a),n.push(t)})),n}var O={init:function(e,n,r){var t=this;if(y.displayModes=p["a"].defaultModes(),this.setActiveDisplayMode("Shaded",!1),null==f){var a=e();console.log("start loading rhino3dm"),n(),a.then((function(e){if(f=e,r(),console.log("rhino3dm loaded"),null!=b){var n=b[0],a=b[1];b=null,t.openFile(n,a)}}))}},getRhino3dm:function(){return f},viewModel:function(){return w},updateVisibility:function(){w.layers.forEach((function(e){var n=y.threeObjectsOnLayer[e.label];null!=n&&n.forEach((function(n){n.visible=e.visible,n.visible&&"Mesh"===n.type&&(n.visible=w.displayMode.showSurfaceMeshes),n.visible&&n.userData["surfaceWires"]&&(n.visible=w.displayMode.showSurfaceWires)}))})),y.threeGrid&&(y.threeGrid.visible=w.displayMode.showGrid)},setActiveDisplayMode:function(e){for(var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=0;r<y.displayModes.length;r++)if(y.displayModes[r].name===e){w.displayMode=y.displayModes[r];break}n&&this.regen(),g.forEach((function(e){e()}))},updateColors:function(){var e=w.displayMode;y.cameraLight.color=new t["h"](e.lightColor),e.backgroundStyle===p["a"].backgroundModes[0]?y.three.setBackground(y.three.background,e.backgroundColor):e.backgroundStyle===p["a"].backgroundModes[1]?y.three.setBackground(y.three.background,e.backgroundGradientTop,e.backgroundGradientBottom):y.three.setBackground(y.three.background,null,null,e.backgroundStyle)},updateMaterial:function(){if(w.currentMaterialStyle!==w.materialOptions[0]){var e=w.currentMaterialStyle.substr("PBR: ".length).toLowerCase();e=e.replace(/ /g,"-"),h["a"].createPBRMaterial(e,this.applyMaterial)}else this.applyMaterial(null)},regen:function(){this.updateVisibility(),this.updateColors(),this.updateMaterial()},applyMaterial:function(e){w.layers.forEach((function(n){var r=y.threeObjectsOnLayer[n.label];null!=r&&r.forEach((function(n){if("Mesh"===n.type)if(n.material&&(n.material.dispose(),n.material=null),null==e){var r=n.userData["diffuse"];n.material=new t["I"]({color:r,side:t["n"]}),w.displayMode.transparency&&(n.material.opacity=w.displayMode.transparency,n.material.transparent=!0)}else n.material=e}))}))},openFile:function(e,n){if(null!=f)if(e.endsWith(".obj")){var r=i.readFile(e,n);this.setActiveDoc(e,r)}else if(e.endsWith(".drc"))l.readFile(e,n);else if(e.endsWith(".ply")){var t=d.readFile(e,n);this.setActiveDoc(e,t)}else{var a=f.File3dm.fromByteArray(n);this.setActiveDoc(e,a)}else b=[e,n]},setActiveDoc:function(e,n){if(console.log("setActiveDoc ("+e+")"),y.rhinoDoc&&y.rhinoDoc.delete(),this.disposeMiddleground(),y.threeObjectsOnLayer={},y.rhinoDoc=n,w.docExists=null!=n,w.filename=e,w.layers.length=0,n){for(var r=n.layers(),t=r.count(),a={layers:{},visible:!0},o=0;o<t;o++){var i=r.get(o),s=i.fullPath,l=s.split("::");m(a,l,i),i.delete()}w.layers=M(a),r.delete()}v.forEach((function(e){e()})),this.regen()},getActiveModel:function(){return y},addActiveDocChangedEventWatcher:function(e){v.push(e)},addDisplayModeChangedEventWatcher:function(e){g.push(e)},disposeMiddleground:function(){y.three.middleground&&(y.three.middleground.dispose(),y.three.middleground=null)},visibleObjectsBoundingBox:function(){var e=null;return w.layers.forEach((function(n){if(n.visible){var r=y.threeObjectsOnLayer[n.label];null!=r&&r.forEach((function(n){null!=n.boundingBox&&(null==e?e=n.boundingBox.clone():e.union(n.boundingBox))}))}})),e}},T=n["a"]=O},"2f39":function(e,n,r){"use strict";r.r(n);var t=r("967e"),a=r.n(t),o=(r("96cf"),r("fa84")),i=r.n(o),s=(r("7d6e"),r("e54f"),r("985d"),r("0047"),r("2b0e")),l=r("1f91"),c=r("42d2"),u=r("b05d"),d=r("f508");s["a"].use(u["a"],{config:{loading:{}},lang:l["a"],iconSet:c["a"],plugins:{Loading:d["a"]}});var h=function(){var e=this,n=e.$createElement,r=e._self._c||n;return r("div",{attrs:{id:"q-app"}},[r("router-view")],1)},p=[],f=r("1bee"),b={name:"App",mounted:function(){f["a"].init(window.rhino3dm,this.showLoading,this.hideLoading)},methods:{showLoading:function(){this.$q.loading.show()},hideLoading:function(){this.$q.loading.hide()}}},v=b,g=r("2877"),w=Object(g["a"])(v,h,p,!1,null,null,null),y=w.exports,m=r("8c4f"),M=[{path:"/",component:function(){return Promise.all([r.e(0),r.e(5)]).then(r.bind(null,"713b"))},children:[{path:"",component:function(){return Promise.all([r.e(0),r.e(1)]).then(r.bind(null,"8b24"))}},{path:"/view",component:function(){return Promise.all([r.e(0),r.e(1)]).then(r.bind(null,"8b24"))},props:function(e){return{query:e.query.q}}}]}];M.push({path:"*",component:function(){return Promise.all([r.e(0),r.e(4)]).then(r.bind(null,"e51e"))}});var O=M;s["a"].use(m["a"]);var T=function(){var e=new m["a"]({scrollBehavior:function(){return{x:0,y:0}},routes:O,mode:"hash",base:""});return e},j=function(){return k.apply(this,arguments)};function k(){return k=i()(a.a.mark((function e(){var n,r;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("function"!==typeof T){e.next=6;break}return e.next=3,T({Vue:s["a"]});case 3:e.t0=e.sent,e.next=7;break;case 6:e.t0=T;case 7:return n=e.t0,r={el:"#q-app",router:n,render:function(e){return e(y)}},e.abrupt("return",{app:r,router:n});case 10:case"end":return e.stop()}}),e)}))),k.apply(this,arguments)}function B(){return x.apply(this,arguments)}function x(){return x=i()(a.a.mark((function e(){var n,r;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,j();case 2:n=e.sent,r=n.app,n.router,new s["a"](r);case 6:case"end":return e.stop()}}),e)}))),x.apply(this,arguments)}B()},cbaf:function(e,n,r){"use strict";r("7f7f");var t=r("fc74"),a=r.n(t);function o(){var e=new u("Wireframe");return e.showSurfaceMeshes=!1,e}function i(){var e=new u("Shaded");return e}function s(){var e=new u("Ghosted");return e.transparency=.5,e}function l(){var e=new u("Rendered");return e.showGrid=!1,e.showSurfaceWires=!1,e}function c(){var e=new u("Arctic");return e.showGrid=!1,e.backgroundColor="rgb(250,250,250)",e.showSurfaceWires=!1,e}var u=function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;a()(this,e),this.name=n,this.showGrid=!0,this.backgroundStyle="Single Color",this.backgroundColor="rgb(157,163,170)",this.backgroundGradientTop="rgb(54,109,168)",this.backgroundGradientBottom="rgb(165,165,165)",this.lightColor="rgb(240,240,240)",this.showSurfaceWires=!0,this.showSurfaceMeshes=!0,this.defaultModes=function(){var e=[];return e.push(o()),e.push(i()),e.push(s()),e.push(l()),e.push(c()),e}},d={defaultModes:function(){return(new u).defaultModes()},backgroundModes:["Single Color","2 Color Gradient"]};n["a"]=d}},[[0,3,0]]]);