(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[1],{"8b24":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-page",{staticClass:"flex flex-center",attrs:{id:"cvs"}},[e.viewmodel.docExists?e._e():n("q-card",{attrs:{flat:""}},[n("q-img",{attrs:{alt:"rview",src:"statics/logo.png"}}),n("q-card-section",[n("div",{staticClass:"text-h6"},[e._v("rview WIP")])])],1),e.viewmodel.docExists?n("q-page-sticky",{attrs:{position:"bottom-left",offset:[10,10]}},[n("q-fab",{attrs:{color:"primary",icon:"keyboard_arrow_up",direction:"up"},model:{value:e.expandSticky,callback:function(t){e.expandSticky=t},expression:"expandSticky"}},[n("q-fab-action",{attrs:{color:e.panMode?"secondary":"primary",icon:"pan_tool"},on:{click:function(t){return e.togglePan()}}},[n("q-tooltip",{attrs:{"transition-show":"flip-right","transition-hide":"flip-left"}},[e._v("\n          Pan\n        ")])],1),n("q-fab-action",{attrs:{color:"primary",icon:"zoom_out_map"},on:{click:function(t){return e.zoomExtents()}}},[n("q-tooltip",{attrs:{"transition-show":"flip-right","transition-hide":"flip-left"}},[e._v("\n          Zoom Extents\n        ")])],1),e.viewmodel.perspectiveCamera?n("q-fab-action",{attrs:{color:"primary",icon:"img:statics/icons/3D.svg"},on:{click:function(t){return e.setProjection(!1)}}}):e._e(),e.viewmodel.perspectiveCamera?e._e():n("q-fab-action",{attrs:{color:"primary",icon:"img:statics/icons/2D.svg"},on:{click:function(t){return e.setProjection(!0)}}})],1)],1):e._e(),e.panMode?n("q-page-sticky",{attrs:{position:"bottom-right",offset:[10,10]}},[n("q-btn",{attrs:{outline:"",rounded:"",color:"primary",label:"Pan Mode","icon-right":"close"},on:{click:function(t){return e.togglePan()}}})],1):e._e()],1)},i=[],o=n("967e"),a=n.n(o),c=(n("34ef"),n("96cf"),n("fa84")),s=n.n(c),l=(n("28a5"),n("5a89")),d=n("4721"),u=n("1bee"),m=n("17c8"),p={renderer:null,camera:null,controls:null,initialize:function(){if(null==this.renderer){l["q"].DefaultUp=new l["A"](0,0,1),this.renderer=new l["B"]({antialias:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(window.innerWidth,window.innerHeight);var e=document.getElementById("cvs");e.appendChild(this.renderer.domElement),window.addEventListener("resize",(function(){return h(!0)}),!1),this.camera=new l["s"](30,window.innerWidth/window.innerHeight,1,1e3),this.camera.position.z=40,this.controls=new d["a"](this.camera,this.renderer.domElement),this.controls.screenSpacePanning=!0}},toPerspectiveCamera:function(){var e=u["a"].viewModel();e.perspectiveCamera=!0,this.zoomExtents(!0)},toParallelCamera:function(){var e=u["a"].viewModel();e.perspectiveCamera=!1,this.zoomExtents(!0)},zoomExtents:function(e){var t=u["a"].getRhino3dm(),n=u["a"].visibleObjectsBoundingBox(),r=new t.BoundingBox(n.min.x,n.min.y,n.min.z,n.max.x,n.max.y,n.max.z),i=new t.ViewportInfo;i.isPerspectiveProjection=u["a"].viewModel().perspectiveCamera;var o=new l["z"](0,0);p.renderer.getSize(o),i.screenPort=[0,0,o.x,o.y];var a=0;u["a"].viewModel().perspectiveCamera?i.setCameraLocation([30,-50,15]):a=.05*(r.max[0]-r.min[0]);var c=r.max[0]-r.min[0],s=c*o.y/o.x;if(i.setFrustum(-c/2,c/2,-s/2,s/2,.1,1e3),i.dollyExtents(r,a),r.delete(),e){u["a"].getActiveDoc().threeScene.remove(this.camera);var d=i.getFrustum();d.near>.1&&(d.near=.1),d.far<1e3&&(d.far=1e3),i.setFrustum(d.left,d.right,d.bottom,d.top,d.near,d.far),u["a"].viewModel().perspectiveCamera?this.camera=new l["s"](30,window.innerWidth/window.innerHeight,1,1e3):(d=i.getFrustum(),this.camera=new l["r"](d.left,d.right,d.top,d.bottom,d.near,d.far),this.camera.up.set(i.cameraUp[0],i.cameraUp[1],i.cameraUp[2])),this.controls.object=this.camera;var m=new l["f"](15658734);m.position.set(0,0,1),this.camera.add(m),u["a"].getActiveDoc().threeScene.add(this.camera)}var h=i.cameraLocation;this.camera.position.x=h[0],this.camera.position.y=h[1],this.camera.position.z=h[2],this.camera.updateProjectionMatrix(),this.controls.target.set(0,0,0),i.delete()}},h=function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t&&(p.camera.aspect=window.innerWidth/window.innerHeight,p.camera.updateProjectionMatrix(),p.renderer.setSize(window.innerWidth,window.innerHeight)),requestAnimationFrame(e),p.controls.update();var n=u["a"].getActiveDoc();p.renderer.render(n.threeScene,p.camera)};function f(){p.initialize();var e=u["a"].getActiveDoc();e.threeScene&&e.threeScene.dispose(),e.threeScene=new l["w"],e.threeScene.background=new l["e"](.75,.75,.75);var t=m["a"].createGrid();e.threeGrid=t,e.threeScene.add(t)}function v(e,t){var n=new l["d"],r=n.parse(e.toThreejsJSON());0===t.r&&0===t.g&&0===t.b&&(t.r=255,t.g=255,t.b=255);var i=new l["e"](t.r/255,t.g/255,t.b/255),o=new l["p"]({color:i,side:l["g"]});return new l["o"](r,o)}function w(){console.log("Building Scene"),f();for(var e=u["a"].getRhino3dm(),t=u["a"].getActiveDoc(),n=t.rhinoDoc,r=n.objects(),i=function(i){var o=r.get(i);if(null==o)return"continue";var a=o.geometry(),c=o.attributes(),s=n.layers().get(c.layerIndex),d=s.fullPath.split("::")[0];t.threeObjectsOnLayer[d]||(t.threeObjectsOnLayer[d]=[]);var u=c.drawColor(n),p=[];if(a instanceof e.Mesh){var h=v(a,u);p.push([h,a.getBoundingBox()])}if(a instanceof e.Brep){for(var f=a.faces(),w=0;w<f.count;w++){var g=f.get(w),x=g.getMesh(e.MeshType.Any);if(x){var y=v(x,u);p.push([y,x.getBoundingBox()]),x.delete()}g.delete()}f.delete()}if(a instanceof e.Curve){var b=m["a"].curveToBufferGeometry(a,21),P=new l["e"](u.r/255,u.g/255,u.b/255),C=new l["l"]({color:P}),E=new l["k"](b,C);p.push([E,a.getBoundingBox()])}if(a instanceof e.Point){var B=new l["u"]({color:u}),q=new l["i"],M=a.location;q.vertices.push(new l["A"](M[0],M[1],M[2])),p.push([new l["t"](q,B),a.getBoundingBox()])}p.forEach((function(e){var n=e[0],r=e[1],i=new l["A"](r.min[0],r.min[1],r.min[2]),o=new l["A"](r.max[0],r.max[1],r.max[2]);n.boundingBox=new l["a"](i,o),r.delete(),t.threeScene.add(n),t.threeObjectsOnLayer[d].push(n)})),o.delete(),a.delete(),c.delete()},o=0;o<r.count;o++)i(o);r.delete(),u["a"].updateVisibility(),p.zoomExtents(!0),h()}var g={data:function(){var e=u["a"].viewModel();return{expandSticky:!1,panMode:!1,viewmodel:e}},props:{url:{type:String,default:""}},created:function(){u["a"].addActiveDocChangedEventWatcher(w),this.viewmodel.onChangeCamera=this.updateCameraProjection},mounted:function(){this.$route.query&&this.$route.query["url"]&&(console.log("MOUNTED with "+this.$route.query["url"]),this.openURL(this.$route.query["url"])),console.log("MOUNTED")},watch:{$route:function(e,t){e.query["url"]&&this.openURL(e.query["url"]),console.log(e.query)}},methods:{openURL:function(e){fetch(e).then(function(){var t=s()(a.a.mark((function t(n){var r,i;return a.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,n.arrayBuffer();case 2:r=t.sent,i=new Uint8Array(r),u["a"].setActiveDoc(e,i);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},updateCameraProjection:function(){this.viewmodel.perspectiveCamera?p.toPerspectiveCamera():p.toParallelCamera(),this.setLeftButtonMode()},zoomExtents:function(){p.zoomExtents(!0)},togglePan:function(){this.panMode=!this.panMode,this.setLeftButtonMode()},setProjection:function(e){this.viewmodel.perspectiveCamera!==e&&(this.viewmodel.perspectiveCamera=e,this.updateCameraProjection(),this.zoomExtents())},setLeftButtonMode:function(){this.panMode||!this.viewmodel.perspectiveCamera?(p.controls.mouseButtons.LEFT=l["n"].PAN,p.controls.touches.ONE=l["y"].PAN):(p.controls.mouseButtons.LEFT=l["n"].ROTATE,p.controls.touches.ONE=l["y"].ROTATE)}}},x=g,y=n("2877"),b=n("eebe"),P=n.n(b),C=n("9989"),E=n("f09f"),B=n("068f"),q=n("a370"),M=n("de5e"),S=n("c294"),z=n("72db"),k=n("05c0"),A=n("9c40"),j=Object(y["a"])(x,r,i,!1,null,null,null);t["default"]=j.exports;P()(j,"components",{QPage:C["a"],QCard:E["a"],QImg:B["a"],QCardSection:q["a"],QPageSticky:M["a"],QFab:S["a"],QFabAction:z["a"],QTooltip:k["a"],QBtn:A["a"]})}}]);