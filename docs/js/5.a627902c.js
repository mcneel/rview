(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[5],{"8b24":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-page",{staticClass:"flex flex-center",attrs:{id:"cvs"}},[e.docExists?e._e():n("q-card",{attrs:{flat:""}},[n("q-img",{attrs:{alt:"rview",src:"statics/logo.png"}}),n("q-card-section",[n("div",{staticClass:"text-h6"},[e._v("rview WIP")])])],1),e.docExists?n("q-page-sticky",{attrs:{position:"bottom-left",offset:[18,18]}},[n("q-fab",{attrs:{color:"primary",icon:"keyboard_arrow_up",direction:"up"}},[n("q-fab-action",{attrs:{color:"primary",icon:"pan_tool",disable:!0}},[n("q-tooltip",{attrs:{"transition-show":"flip-right","transition-hide":"flip-left"}},[e._v("\n          (TODO) implement pan\n        ")])],1),n("q-fab-action",{attrs:{color:"primary",icon:"zoom_out_map"},on:{click:function(t){return e.zoomExtents()}}},[n("q-tooltip",{attrs:{"transition-show":"flip-right","transition-hide":"flip-left"}},[e._v("\n          Zoom Extents\n        ")])],1)],1)],1):e._e()],1)},i=[],a=(n("63d9"),n("28a5"),n("5a89")),o=n("4721"),s=n("1bee"),c={renderer:null,camera:null,controls:null,initialize:function(){if(null==this.renderer){a["n"].DefaultUp=new a["w"](0,0,1),this.renderer=new a["x"]({antialias:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(window.innerWidth,window.innerHeight);var e=document.getElementById("cvs");e.appendChild(this.renderer.domElement),window.addEventListener("resize",(function(){return d(!0)}),!1),this.camera=new a["o"](30,window.innerWidth/window.innerHeight,1,1e3),this.camera.position.z=40,this.controls=new o["a"](this.camera,this.renderer.domElement)}},setToPerspectiveCamera:function(){var e=s["a"].viewModel();e.perspectiveCamera||(e.perspectiveCamera=!0)},setToParallelCamera:function(){var e=s["a"].viewModel();e.perspectiveCamera&&(e.perspectiveCamera=!1)},zoomExtents:function(){var e=s["a"].getRhino3dm(),t=s["a"].visibleObjectsBoundingBox(),n=new e.ViewportInfo;n.isPerspectiveProjection=s["a"].viewModel().perspectiveCamera;var r=new a["v"](0,0);c.renderer.getSize(r),n.screenPort=[0,0,r.x,r.y],n.dollyExtents(t,0),t.delete();var i=n.cameraLocation;c.camera.position.x=i[0],c.camera.position.y=i[1],c.camera.position.z=i[2],n.delete()}},d=function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t&&(c.camera.aspect=window.innerWidth/window.innerHeight,c.camera.updateProjectionMatrix(),c.renderer.setSize(window.innerWidth,window.innerHeight)),requestAnimationFrame(e),c.controls.update();var n=s["a"].getActiveDoc();c.renderer.render(n.threeScene,c.camera)};function l(){c.initialize();var e=s["a"].getActiveDoc();e.threeScene&&e.threeScene.dispose(),e.threeScene=new a["s"],e.threeScene.background=new a["d"](.9,.9,.9);var t=new a["e"](16777215);t.position.set(0,0,1),e.threeScene.add(t);var n=new a["e"](6710886);n.position.set(.2,.2,-1),e.threeScene.add(n)}function p(e,t){var n=new a["c"],r=n.parse(e.toThreejsJSON());0===t.r&&0===t.g&&0===t.b&&(t.r=255,t.g=255,t.b=255);var i=new a["d"](t.r/255,t.g/255,t.b/255),o=new a["m"]({color:i,side:a["f"]});return new a["l"](r,o)}function u(){console.log("Building Scene"),l();for(var e=s["a"].getRhino3dm(),t=s["a"].getActiveDoc(),n=t.rhinoDoc,r=n.objects(),i=function(i){var o=r.get(i);if(null==o)return"continue";var s=o.geometry(),c=o.attributes(),d=n.layers().get(c.layerIndex),l=d.fullPath.split("::")[0];t.threeObjectsOnLayer[l]||(t.threeObjectsOnLayer[l]=[]);var u=c.drawColor(n),v=[];if(s instanceof e.Mesh){var h=p(s,u);v.push(h)}if(s instanceof e.Brep){for(var w=s.faces(),f=0;f<w.count;f++){var m=w.get(f),g=m.getMesh(e.MeshType.Any);if(g){var b=p(g,u);v.push(b),g.delete()}m.delete()}w.delete()}if(s instanceof e.Curve){var C=21;s instanceof e.LineCurve?C=2:s instanceof e.PolylineCurve&&(C=s.pointCount);for(var x=new a["b"],y=new Float32Array(3*C),P=s.domain,S=C-1,E=0;E<C;E++){var z=P[0]+E/S*(P[1]-P[0]),j=s.pointAt(z);y[3*E]=j[0],y[3*E+1]=j[1],y[3*E+2]=j[2]}x.setAttribute("position",new a["a"](y,3));var q=new a["d"](u.r/255,u.g/255,u.b/255),_=new a["j"]({color:q}),O=new a["i"](x,_);v.push(O)}if(s instanceof e.Point){var A=new a["q"]({color:u}),M=new a["h"],Q=s.location;M.vertices.push(new a["w"](Q[0],Q[1],Q[2])),v.push(new a["p"](M,A))}v.forEach((function(e){t.threeScene.add(e),t.threeObjectsOnLayer[l].push(e)})),o.delete(),s.delete(),c.delete()},o=0;o<r.count;o++)i(o);r.delete(),s["a"].updateVisibility(),c.zoomExtents(),d()}var v={data:function(){return s["a"].viewModel()},created:function(){s["a"].addActiveDocChangedEventWatcher(u),this.onChangeCamera=this.updateCameraProjection},methods:{updateCameraProjection:function(){this.perspectiveCamera?c.SetToPerspectiveCamera():c.SetToParallelCamera()},zoomExtents:function(){c.zoomExtents()}}},h=v,w=n("2877"),f=n("eebe"),m=n.n(f),g=n("9989"),b=n("f09f"),C=n("068f"),x=n("a370"),y=n("de5e"),P=n("c294"),S=n("72db"),E=n("05c0"),z=Object(w["a"])(h,r,i,!1,null,null,null);t["default"]=z.exports;m()(z,"components",{QPage:g["a"],QCard:b["a"],QImg:C["a"],QCardSection:x["a"],QPageSticky:y["a"],QFab:P["a"],QFabAction:S["a"],QTooltip:E["a"]})}}]);